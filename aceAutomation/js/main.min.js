var __awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(o,s){function r(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(r,a)}l((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function a(l){if(n)throw TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(r=0)),r;)try{if(n=1,i&&(o=2&l[0]?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===l[0]||2===l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(u){l=[6,u],i=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([a,l])}}},_this=this,ace=ace,js_beautify=js_beautify,babel=Babel;babel.availablePlugins.preventInfiniteLoops=preventInfiniteLoops;var babelOptions={presets:["es2015"],plugins:["preventInfiniteLoops"]},getInterpreter=function(e,t){return new Interpreter(e,t)};ace.require("ace/ext/language_tools");var BASE_URL="./",Editor=function(){function e(e){this.editor=e}return e.prototype.getEditor=function(){return this.editor},e.prototype.setTheme=function(e){this.editor.setTheme(e)},e.prototype.setFontSize=function(e){this.editor.setFontSize(e+"px")},e}(),Question=function(){function e(e){this.page=0,this.questions=[],this.questionsCount=0,this.page=0,this.questions=e,this.questionsCount=this.questions.length}return e.prototype.nextPage=function(){if(this.page<this.questionsCount-1)return this.page++,feedQuestion(),!0},e.prototype.prevPage=function(){this.page>0&&(this.page--,feedQuestion())},e.prototype.getPage=function(){return this.page},e.prototype.totalPage=function(){return this.questionsCount},e.prototype.getQuestion=function(){return this.questions[this.page]},e.prototype.getTestCases=function(){return this.questions[this.page].testCases},e.prototype.getQuestionId=function(){return this.questions[this.page]._id||this.questions[this.page].qid},e.prototype.updateTemplate=function(e){this.questions[this.page].template=e},e}(),myEditor=new Editor(ace.edit("editor",{theme:localStorage.getItem("GJSW-theme")||"ace/theme/monokai",mode:"ace/mode/javascript",enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,wrap:!0,fontSize:(localStorage.getItem("GJSW-fs")||16)+"px",autoScrollEditorIntoView:!0,copyWithEmptySelection:!0,firstLineNumber:0,enableEmmet:!0,enableAutoIndent:!0})),myQuestions=function(){var e;return{setQuestions:function(t){e=t},getQuestions:function(){return e}}}(),dummyElement=function(){return document.createElement("")},scrollEditor=function(e){void 0===e&&(e="bottom");var t=document.querySelector(".code-editor")||dummyElement();"bottom"===e?t.scrollTo({top:t.scrollHeight+30,behavior:"smooth"}):t.scrollTo({top:0,behavior:"smooth"})},navTab=document.getElementById("nav-tab")||dummyElement();navTab.addEventListener("click",function(){scrollEditor()});var themeSelect=document.getElementById("theme-select")||dummyElement();themeSelect.value=localStorage.getItem("GJSW-theme")||"ace/theme/monokai",themeSelect.addEventListener("change",function(){localStorage.setItem("GJSW-theme",themeSelect.value),myEditor.setTheme(themeSelect.value)});var loopLimitRange=document.getElementById("loopLimitRange")||dummyElement();loopLimitRange.value=""+MAX_SOURCE_ITERATIONS;var loopLimit=document.getElementById("loopLimit")||dummyElement();loopLimit.innerText=loopLimitRange.value,loopLimitRange.addEventListener("input",function(){var e=loopLimitRange.value;MAX_SOURCE_ITERATIONS=parseInt(e,10),loopLimit.innerText=e});var editorFontSize=document.getElementById("editorFontSize")||dummyElement();editorFontSize.value=localStorage.getItem("GJSW-fs")||"16";var fontSize=document.getElementById("fontSize")||dummyElement();fontSize.innerText=editorFontSize.value+"px",editorFontSize.addEventListener("input",function(){var e=editorFontSize.value;localStorage.setItem("GJSW-fs",e),myEditor.setFontSize(e),fontSize.innerText=e+"px",fontSize.style.setProperty("font-size",e,"important")});var compilerMsg=document.getElementById("compileMsg")||dummyElement(),clearCC=function(){compilerMsg.innerHTML="",compilerMsg.className="text-danger",(document.getElementById("console-log-text")||dummyElement()).innerHTML=""},download=function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},myData={key:"getWebtoolQuestions"};window.onload=function(){return __awaiter(_this,void 0,void 0,function(){var e,t,n,i;return __generator(this,function(o){switch(o.label){case 0:return[4,fetch("https://guviv2.codingpuppet.com/model/webtool.php",{method:"POST",body:JSON.stringify(myData)})];case 1:return[4,(e=o.sent()).json()];case 2:return t=o.sent(),n=new Question(t),myQuestions.setQuestions(n),(document.querySelector("#totalQuestions")||dummyElement()).innerHTML=""+n.totalPage(),feedQuestion(),null===(i=document.querySelector("#editor"))||void 0===i||i.addEventListener("click",function(){scrollEditor("top")}),[2]}})})};var validateMail=function(e){var t=e.indexOf("@"),n=e.lastIndexOf("@"),i=e.lastIndexOf(".");return!(e.indexOf(" ")>=0)&&n===t&&!(t<1)&&!(i<t+2)&&!(i+2>=e.length)},manageNavBtn=function(e,t){document.querySelectorAll(".nav-btn")[0].disabled=!e,document.querySelectorAll(".nav-btn")[1].disabled=!(-t+e+1)},feedQuestion=function(){return __awaiter(_this,void 0,void 0,function(){var e,t,n,i,o,s,r;return __generator(this,function(a){return myEditor.getEditor().setValue(""),manageNavBtn((e=myQuestions.getQuestions()).getPage(),e.totalPage()),(document.querySelector("#questionNo")||dummyElement()).innerHTML=1+e.getPage(),t=document.getElementById("question")||dummyElement(),(n=document.getElementById("testcases")||dummyElement()).innerHTML="",i=e.getQuestion(),t.innerHTML=i.question,s=(o=sessionStorage.getItem("jsWarmupSolution"+e.getQuestionId()))||i.template+"\n/*\nLines For TestCase\n",i.testCases.forEach(function(e,t){var i=document.createElement("div");i.className="p-2 bd-highlight g-2 testcase",i.id="test"+t,i.innerHTML='\n        <div class = "d-flex justify-content-between align-items-center">\n          <span class="p-2 bd-highlight">'.concat(e.output,'</span>\n          <i id="test').concat(t,'i" class=""></i>\n        </div>\n    '),o||(s+="\n".concat(e.input)),null==n||n.appendChild(i)}),s+=o?"":"\n*/",s=js_beautify(s,r={indent_size:1,space_in_empty_paren:!0,indent_with_tabs:!0,indent_empty_lines:!0}),myEditor.getEditor().setValue(s),scrollEditor("top"),clearCC(),[2]})})},prevPage=function(){myQuestions.getQuestions().prevPage()},nextPage=function(){myQuestions.getQuestions().nextPage()},initFunc=function(e,t){var n=e.nativeToPseudo(console);e.setProperty(t,"console",n)},compile=function(e,t){return(document.getElementById("console-log-div")||dummyElement()).style.display="inline-block",compilerMsg.innerHTML="Compiling....",new Promise(function(n,i){e=babel.transform(e+"\n"+t.input,babelOptions).code;var o=getInterpreter(e,initFunc);console.head("Sample testcase :::: ",t.input),o.run(),n(o.value)})},runCode=function(){(document.getElementById("nav-output-tab")||dummyElement()).click(),document.querySelectorAll(".top-bar>*>[type=button]").forEach(function(e){e.disabled=!0}),clearCC();var e=myQuestions.getQuestions(),t=e.getTestCases(),n=myEditor.getEditor().getValue();sessionStorage.setItem("jsWarmupSolution"+e.getQuestionId(),n.replace(/^\s*\n/gm,"")),compile(n,t[0]).then(function(e){console.log(e),compilerMsg.innerHTML="",""==(document.getElementById("console-log-text")||dummyElement()).innerText&&(compilerMsg.innerHTML="Compilation is Successfull",compilerMsg.className="text-success",console.warn("There is no conosle statement to print the output"))},function(e){compilerMsg.innerText=e,compilerMsg.className="text-danger"}).finally(function(){scrollEditor(),document.querySelectorAll(".top-bar>*>[type=button]").forEach(function(e){e.disabled=!1})})},submitCode=function(){document.querySelectorAll(".top-bar>*>[type=button]").forEach(function(e){e.disabled=!0}),(document.getElementById("nav-testcases-tab")||dummyElement()).click();var e=myQuestions.getQuestions(),t=e.getTestCases(),n=myEditor.getEditor().getValue();sessionStorage.setItem("jsWarmupSolution"+e.getQuestionId(),n.replace(/^\s*\n/gm,"")),compile(n,t[0]).then(function(){clearCC(),t.forEach(function(e,i){var o=babel.transform(n+"\n"+e.input,babelOptions).code,s=getInterpreter(o,initFunc);console.head("For testcase :::: ",e.input),s.run();var r=document.getElementById("test"+i)||dummyElement(),a=document.querySelector("#test"+i+"i")||dummyElement();t[i].output===s.value?(r.className="p-2 bd-highlight testcase g-2 pass",a.className="bi bi-check-circle-fill text-success"):(r.className="p-2 bd-highlight testcase g-2 fail",a.className="bi bi-x-circle-fill text-danger")})},function(e){compilerMsg.innerText=e}).finally(function(){scrollEditor(),document.querySelectorAll(".top-bar>*>[type=button]").forEach(function(e){e.disabled=!1})})},htmlToText=function(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""},initiateDownload=function(){download("GUVI WarmUp - ".concat(myQuestions.getQuestions().getPage(),".").concat(document.querySelector("#file-type-select").value),"/* ".concat(htmlToText(myQuestions.getQuestions().getQuestion().question)," */\n\n").concat(js_beautify(myEditor.getEditor().getValue(),{indent_size:1,space_in_empty_paren:!0,indent_with_tabs:!0,indent_empty_lines:!0})))};